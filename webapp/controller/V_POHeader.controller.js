sap.ui.define([
	"POReportForSCM/controller/BaseController",
	"sap/ui/model/json/JSONModel",
	"sap/ui/model/Filter",
	"sap/ui/model/FilterOperator",
	"sap/ui/model/FilterType",
], function(BaseController, JSONModel, Filter, FilterOperator, FilterType) {
	"use strict";

	return BaseController.extend("POReportForSCM.controller.V_POHeader", {

		onInit: function() {
			
			var dataModel = new JSONModel(),
				oModel = this.getOwnerComponent().getModel(),
				oTable = this.getView().byId("poHeaderTableId");
			var oFilters = [];

			oModel.read("/POHeaderSet", {

				filters: oFilters,
				method: "GET",
				success: function(data) {
					dataModel.setData(data);
					this.getView().setModel(dataModel, "dataModel");
					oTable.setBusy(false);
				},
				error: function() {
					oTable.setBusy(false);
				}

			});

		},

		onFindPress: function(oEvent) {
			// debugger;
			var oRouter = sap.ui.core.UIComponent.getRouterFor(this);
			oRouter.navTo("Route_FindItem", {});
		},

		navigateToRoute: function(routeName) {
			debugger;
			//This code was generated by the layout editor.
			var oTable = this.getView().byId("poHeaderTableId");
			var oItem = oTable.getSelectedItem();
			if (!oItem) {
				jQuery.sap.require("sap.m.MessageBox");
				var message = "Please select Purchase Order";
				sap.m.MessageBox.show(message, {
					icon: sap.m.MessageBox.Icon.Failure,
					title: "Select PO",
					actions: [sap.m.MessageBox.Action.OK]
				});
				return;
			}
			var selectPO = oItem.getBindingContext().getProperty("Ebeln");

			// var selectPO = oEvent.getSource().getBindingContext().getProperty("Ebeln");
			var oRouter = sap.ui.core.UIComponent.getRouterFor(this);
			oRouter.navTo(routeName, {
				selectedPO: selectPO
			});
		},

		GoToDetails: function(oEvent) {
			debugger;
			//This code was generated by the layout editor.
			// var selectPO = oEvent.getSource().getBindingContext().getProperty("Ebeln");
			// var oRouter = sap.ui.core.UIComponent.getRouterFor(this);
			// oRouter.navTo("Route_PODetail", {
			// 	SelectedItem: selectPO
			// });
			this.navigateToRoute("Route_PODetail");
		},

		ChangePO: function(oEvent) {
			debugger;

			this.navigateToRoute("Route_ChangePO");
		},

		CreatePO: function(oEvent) {

			var oRouter = sap.ui.core.UIComponent.getRouterFor(this);
			oRouter.navTo("Route_CreatePO", {});
		},

		onFilterPressed: function(oEvent) {

			var oTable = this.getView().byId("poHeaderTableId"),
				docNo = oController.byId("docNoId").getValue(),
				companyCode = oController.byId("companyCodeId").getValue(),
				createdBy = oController.byId("createdById").getValue(),
				docType = oController.byId("docTypeId").getValue();
			var oFilters = [];

			if (contractNo) {
				oFilters.push(new Filter("Ebeln", FilterOperator.EQ, docNo));
			}

			if (companyCode) {
				oFilters.push(new Filter("Bukrs", FilterOperator.EQ, companyCode));
			}

			if (createdBy) {
				oFilters.push(new Filter("Ernam", FilterOperator.EQ, createdBy));
			}

			if (docType) {
				oFilters.push(new Filter("Bsart", FilterOperator.EQ, docType));
			}

			var oModel = this.getOwnerComponent().getModel();
			dataModel = this.getView().getModel("dataModel"),

				oTable.setBusy(true);

			oModel.read("/POHeaderSet", {
				filters: oFilters,
				method: "GET",
				success: function(data) {
					dataModel.setData(data);
					oTable.setBusy(false);
				},
				error: function() {
					oTable.setBusy(false);
				}
			});

		},

		// onFilterPO: function(oEvent) {

		// 	// build filter array
		// 	var aFilter = [];
		// 	var sQuery = oEvent.getSource().getValue();
		// 	var aFilter = new Filter(
		// 		"Bsart",
		// 		FilterOperator.Contains,
		// 		sQuery
		// 	);

		// 	// if (sQuery) {
		// 	// 	aFilter.push(new Filter("Bsart", FilterOperator.Contains, sQuery));
		// 	// }
		// 	debugger;
		// 	// filter binding
		// 	var oBinding = this.getView().byId("POList").getBinding("items");
		// 	// var oBinding = oList;
		// 	oBinding.filter(aFilter, FilterType.Application);
		// }

	});

});